<!--inventory sheetworkers-->
 
<script type="text/worker">
/* ---- BEGIN: TheAaronSheet.js ---- */
// Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
// By:       The Aaron, Arcane Scriptomancer
// Contact:  https://app.roll20.net/users/104025/the-aaron
 
var TAS = TAS || (function(){
    'use strict';
 
    var version = '0.2.4',
        lastUpdate = 1457098091,
 
        loggingSettings = {
            debug: {
                key:     'debug',
                title:   'DEBUG',
                color: {
                    bgLabel: '#7732A2',
                    label:   '#F2EF40',
                    bgText:  '#FFFEB7',
                    text:    '#7732A2'
                }
            },
            error: {
                key:     'error',
                title:   'Error',
                color: {
                    bgLabel: '#C11713',
                    label:   'white',
                    bgText:  '#C11713',
                    text:    'white'
                }
            },
            warn: {
                key:     'warn',
                title:   'Warning',
                color: {
                    bgLabel: '#F29140',
                    label:   'white',
                    bgText:  '#FFD8B7',
                    text:    'black'
                }
            },
            info: {
                key:     'info',
                title:   'Info',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#B3B2EB',
                    text:    'black'
                }
            },
            notice: {
                key:     'notice',
                title:   'Notice',
                color: {
                    bgLabel: '#33C133',
                    label:   'white',
                    bgText:  '#ADF1AD',
                    text:    'black'
                }
            },
            log: {
                key:     'log',
                title:   'Log',
                color: {
                    bgLabel: '#f2f240',
                    label:   'black',
                    bgText:  '#ffff90',
                    text:    'black'
                }
            },
            callstack: {
                key:     'TAS',
                title:   'function',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#B3B2EB',
                    text:    'black'
                }
            },
            callstack_async: {
                key:     'TAS',
                title:   'ASYNC CALL',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#413FA9',
                    text:    'white'
                }
            },
            TAS: {
                key:     'TAS',
                title:   'TAS',
                color: {
                    bgLabel: 'grey',
                    label:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                    bgText:  'grey',
                    text:    'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
                }
            }
        },
 
 
        config = {
            debugMode: false,
            logging: {
                log: true,
                notice: true,
                info: true,
                warn: true,
                error: true,
                debug: false
            }
        },
 
        callstackRegistry = [],
		queuedUpdates = {}, //< Used for delaying saves till the last momment.
 
    complexType = function(o){
        switch(typeof o){
            case 'string':
                return 'string';
            case 'boolean':
                return 'boolean';
            case 'number':
                return (_.isNaN(o) ? 'NaN' : (o.toString().match(/\./) ? 'decimal' : 'integer'));
            case 'function':
                return 'function: '+(o.name ? o.name+'()' : '(anonymous)');
            case 'object':
                return (_.isArray(o) ? 'array' : (_.isArguments(o) ? 'arguments' : ( _.isNull(o) ? 'null' : 'object')));
            default:
                return typeof o;
        }
    },
 
	dataLogger = function(primaryLogger,secondaryLogger,data){
        _.each(data,function(m){
            var type = complexType(m);
            switch(type){
                case 'string':
                    primaryLogger(m);
                    break;
                case 'undefined':
                case 'null':
                case 'NaN':
                    primaryLogger('['+type+']');
                    break;
                case 'number':
                case 'not a number':
                case 'integer':
                case 'decimal':
                case 'boolean':
                    primaryLogger('['+type+']: '+m);
                    break;
                default:
                    primaryLogger('['+type+']:=========================================');
                    secondaryLogger(m);
                    primaryLogger('=========================================================');
                    break;
            }
        });
	},
 
 
    colorLog = function(options){
        var coloredLoggerFunction,
            key = options.key,
            label = options.title || 'TAS',
            lBGColor = (options.color && options.color.bgLabel) || 'blue',
            lTxtColor = (options.color && options.color.label) || 'white',
            mBGColor = (options.color && options.color.bgText) || 'blue',
            mTxtColor = (options.color && options.color.text) || 'white';
 
        coloredLoggerFunction = function(message){
            console.log(
                '%c '+label+': %c '+message + ' ',
                'background-color: '+lBGColor+';color: '+lTxtColor+'; font-weight:bold;',
                'background-color: '+mBGColor+';color: '+mTxtColor+';'
            ); 
        };
        return function(){
            if('TAS'===key || config.logging[key]){
               dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
            }
        };
    },
 
    logDebug  = colorLog(loggingSettings.debug),
    logError  = colorLog(loggingSettings.error),
    logWarn   = colorLog(loggingSettings.warn),
    logInfo   = colorLog(loggingSettings.info),
    logNotice = colorLog(loggingSettings.notice),
    logLog    = colorLog(loggingSettings.log),
    log       = colorLog(loggingSettings.TAS),
    logCS     = colorLog(loggingSettings.callstack),
    logCSA    = colorLog(loggingSettings.callstack_async),
 
    registerCallstack = function(callstack,label){
        var idx=_.findIndex(callstackRegistry,function(o){
            return (_.difference(o.stack,callstack).length === _.difference(callstack,o.stack).length) &&
                _.difference(o.stack,callstack).length === 0 &&
                o.label === label;
        });
        if(-1 === idx){
            idx=callstackRegistry.length;
            callstackRegistry.push({
                stack: callstack,
                label: label
            });
        }
        return idx;
    },
 
    setConfigOption = function(options){
        var newconf =_.defaults(options,config);
        newconf.logging=_.defaults(
            (options && options.logging)||{},
            config.logging
        );
        config=newconf;
    },
 
    debugMode = function(){
        config.logging.debug=true;
        config.debugMode = true;
    },
 
    getCallstack = function(){
        var e = new Error('dummy'),
            stack = _.map(_.rest(e.stack.replace(/^[^\(]+?[\n$]/gm, '')
            .replace(/^\s+at\s+/gm, '')
            .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
            .split('\n')),function(l){
                return l.replace(/\s+.*$/,'');
            });
        return stack;
    },
    logCallstackSub = function(cs){
        var matches, csa;
        _.find(cs,function(line){
            matches = line.match(/TAS_CALLSTACK_(\d+)/);
            if(matches){
               csa=callstackRegistry[matches[1]];
               logCSA( '===================='+(csa.label ? '> '+csa.label+' <' : '')+'====================');
               logCallstackSub(csa.stack);
               return true;
            } 
            logCS(line);
            return false;
        });
    },
    logCallstack = function(){
        var cs;
        if(config.debugMode){
            cs = getCallstack();
            cs.shift();
            log('==============================> CALLSTACK <==============================');
            logCallstackSub(cs);
            log('=========================================================================');
        }
    },
 
 
    wrapCallback = function (label, callback, context){
        var callstack;
        if('function' === typeof label){
            context=callback;
            callback=label;
            label=undefined;
        }
        if(!config.debugMode){
            return (function(cb,ctx){
                return function(){
                    cb.apply(ctx||{},arguments);
                };
            }(callback,context));
        }
 
        callstack = getCallstack();
        callstack.shift();
 
        return (function(cb,ctx,cs,lbl){
            var ctxref=registerCallstack(cs,lbl);
 
            /*jshint -W054 */
            return new Function('cb','ctx','TASlog',
                "return function TAS_CALLSTACK_"+ctxref+"(){"+
                    "TASlog('Entering: '+(cb.name||'(anonymous function)'));"+
                    "cb.apply(ctx||{},arguments);"+
                    "TASlog('Exiting: '+(cb.name||'(anonymous function)'));"+
                "};")(cb,ctx,log);
            /*jshint +W054 */
        }(callback,context,callstack,label));
    },
 
 
    prepareUpdate = function( attribute, value ){
        queuedUpdates[attribute]=value;
    },
 
    applyQueuedUpdates = function() {
      setAttrs(queuedUpdates);
      queuedUpdates = {};
    },
 
	namesFromArgs = function(args,base){
        return _.chain(args)
            .reduce(function(memo,attr){
                if('string' === typeof attr) {
                    memo.push(attr);
                } else if(_.isArray(args) || _.isArguments(args)){
                    memo = namesFromArgs(attr,memo);
                }
                return memo;
            },(_.isArray(base) && base) || [])
            .uniq()
            .value();
	},
 
	addId = function(obj,value){
		Object.defineProperty(obj,'id',{
			value: value,
			writeable: false,
			enumerable: false
		});
	},
 
	addProp = function(obj,prop,value,fullname){
		(function(){
            var pname=(_.contains(['S','F','I','D'],prop) ? '_'+prop : prop),
			    full_pname = fullname || prop,
                pvalue=value;
 
            _.each(['S','I','F'],function(p){
                if( !_.has(obj,p)){
                    Object.defineProperty(obj, p, {
                        value: {},
                        enumerable: false,
                        readonly: true
                    });
                }
            });
            if( !_.has(obj,'D')){
                Object.defineProperty(obj, 'D', {
                    value: _.reduce(_.range(10),function(m,d){
                            Object.defineProperty(m, d, {
                                value: {},
                                enumerable: true,
                                readonly: true
                            });
                            return m;
                        },{}),
                    enumerable: false,
                    readonly: true
                });
            }
 
 
            // Raw value
			Object.defineProperty(obj, pname, {
                enumerable: true,
				set: function(v){
                    if(v!==pvalue) {
                        pvalue=v;
                        prepareUpdate(full_pname,v);
                    }
				},
				get: function(){
					return pvalue;
				}
			});
 
            // string value
			Object.defineProperty(obj.S, pname, {
                enumerable: true,
				set: function(v){
                    var val=v.toString();
                    if(val !== pvalue) {
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return pvalue.toString();
				}
			});
 
            // int value
			Object.defineProperty(obj.I, pname, {
                enumerable: true,
				set: function(v){
                    var val=parseInt(v,10) || 0;
                    if(val !== pvalue){
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return parseInt(pvalue,10) || 0;
				}
			});
 
            // float value
			Object.defineProperty(obj.F, pname, {
                enumerable: true,
				set: function(v){
                    var val=parseFloat(v) || 0;
                    if(val !== pvalue) {
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return parseFloat(pvalue) || 0;
				}
			});
            _.each(_.range(10),function(d){
                Object.defineProperty(obj.D[d], pname, {
                    enumerable: true,
                    set: function(v){
                        var val=(parseFloat(v) || 0).toFixed(d);
                        if(val !== pvalue){
                            pvalue=val;
                            prepareUpdate(full_pname,val);
                        }
                    },
                    get: function(){
                        return (parseFloat(pvalue) || 0).toFixed(d);
                    }
                });
            });
 
		}());
	},
 
	repeating = function( section ) {
		return (function(s){
			var sectionName = s,
				attrNames = [],
				fieldNames = [],
				operations = [],
                after = [],
 
			repAttrs = function TAS_Repeating_Attrs(){
				attrNames = namesFromArgs(arguments,attrNames);
				return this;
			},
			repFields = function TAS_Repeating_Fields(){
				fieldNames = namesFromArgs(arguments,fieldNames);
				return this;
			},
			repReduce = function TAS_Repeating_Reduce(func, initial, final, context) { 
				operations.push({
                    type: 'reduce',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    memo: (_.isUndefined(initial) && 0) || initial,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
			},
			repMap = function TAS_Repeating_Map(func, final, context) {
				operations.push({
                    type: 'map',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
			},
            repEach = function TAS_Repeating_Each(func, final, context) {
				operations.push({
                    type: 'each',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
            },
            repTap = function TAS_Repeating_Tap(final, context) {
				operations.push({
                    type: 'tap',
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
            },
            repAfter = function TAS_Repeating_After(callback,context) {
				after.push({
                    callback: (callback && _.isFunction(callback) && callback) || _.noop,
                    context: context || {}
                });
				return this;
            },
			repExecute = function TAS_Repeating_Execute(callback,context){
				var rowSet = {},
					attrSet = {},
					fieldIds = [],
					fullFieldNames = [];
 
                repAfter(callback,context);
 
				// call each operation per row.
				// call each operation's final
				getSectionIDs("repeating_"+sectionName,function(ids){
					fieldIds = ids;
					fullFieldNames = _.reduce(fieldIds,function(memo,id){
						return memo.concat(_.map(fieldNames,function(name){
							return 'repeating_'+sectionName+'_'+id+'_'+name;  
						}));
					},[]);
					getAttrs( _.uniq(attrNames.concat(fullFieldNames)), function(values){
						_.each(attrNames,function(aname){
							if(values.hasOwnProperty(aname)){
								addProp(attrSet,aname,values[aname]);
							}
						});
 
						rowSet = _.reduce(fieldIds,function(memo,id){
							var r={};
							addId(r,id);
							_.each(fieldNames,function(name){
								var fn = 'repeating_'+sectionName+'_'+id+'_'+name;  
								addProp(r,name,values[fn],fn);
							});
 
							memo[id]=r;
 
							return memo;
						},{});
 
                        _.each(operations,function(op){
                            var res;
                            switch(op.type){
                                case 'tap':
                                    _.bind(op.final,op.context,rowSet,attrSet)();
                                    break;
 
                                case 'each':
                                    _.each(rowSet,function(r){
                                        _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,rowSet,attrSet)();
                                    break;
 
                                case 'map':
                                    res = _.map(rowSet,function(r){
                                        return _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,res,rowSet,attrSet)();
                                    break;
 
                                case 'reduce':
                                    res = op.memo;
                                    _.each(rowSet,function(r){
                                        res = _.bind(op.func,op.context,res,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,res,rowSet,attrSet)();
                                    break;
                            }
                        });
 
                        // finalize attrs
                        applyQueuedUpdates();
                        _.each(after,function(op){
                            _.bind(op.callback,op.context)();
                        });
					});
				});
			};
 
			return {
				attrs: repAttrs,
				attr: repAttrs,
 
				column: repFields,
				columns: repFields,
				field: repFields,
				fields: repFields,
 
				reduce: repReduce,
				inject: repReduce,
				foldl: repReduce,
 
				map: repMap,
				collect: repMap,
 
				each: repEach,
                forEach: repEach,
 
                tap: repTap,
                'do': repTap,
 
				after: repAfter,
				last: repAfter,
				done: repAfter,
 
				execute: repExecute,
				go: repExecute,
				run: repExecute
			};
		}(section));
	},
 
 
    repeatingSimpleSum = function(section, field, destination){
        repeating(section)
            .attr(destination)
            .field(field)
            .reduce(function(m,r){
                return m + (r.F[field]);
            },0,function(t,r,a){
                a.S[destination]=t;
            })
            .execute();
    };
 
	console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  The Aaron Sheet  v'+version+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
	console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  Last update: '+(new Date(lastUpdate*1000))+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
 
 
    return {
        /* Repeating Sections */
        repeatingSimpleSum: repeatingSimpleSum,
		repeating: repeating,
 
        /* Configuration */
        config: setConfigOption,
 
        /* Debugging */
        callback: wrapCallback,
        callstack: logCallstack,
        debugMode: debugMode,
        _fn: wrapCallback,
 
        /* Logging */
        debug: logDebug,
        error: logError,
        warn: logWarn,
        info: logInfo,
        notice: logNotice,
        log: logLog
    };
}());
 
/* ---- END: TheAaronSheet.js ---- */
 
<!--inventory weight calculation-->
// Equipment Carried Section
// https://app.roll20.net/users/877778/sfx helped me with the following two sheet workers
on('change:repeating_inventtab1', function(){
    TAS.repeating('inventtab1')
    .attrs('tempweight')
    .fields('itemwornenc', 'itemquantity')
    .reduce(function(m,r){
        m.itemwornenc+=(r.F.itemwornenc*r.I.itemquantity);
        r.D[0].tempweight=(r.F.itemwornenc*r.I.itemquantity);
        return m;
    },{itemwornenc:0,itemquantity:0, desc: []}, function (m,r,a){
    a.tempweight=m.itemwornenc;
    })
    .execute();
})
on('sheet:opened', function(){
    TAS.repeating('inventtab1')
    .attrs('tempweight')
    .fields('itemwornenc', 'itemquantity')
    .reduce(function(m,r){
        m.itemwornenc+=(r.F.itemwornenc*r.I.itemquantity);
        r.D[0].tempweight=(r.F.itemwornenc*r.I.itemquantity);
        return m;
    },{itemwornenc:0,itemquantity:0, desc: []}, function (m,r,a){
    a.tempweight=m.itemwornenc;
    })
    .execute();
})
 
  // Transitioning from old sheet to new sheet. 
  // https://app.roll20.net/users/726129/jakob helped me with this sheetworker
var fillRepeatingSectionFromData = (sectionName, dataList) => {
  const createdIDs = [];
  const setting = dataList.map(o => {
      let rowID;
      while (!rowID) {
        let newID = generateRowID();
        if (!createdIDs.includes(newID)) {
          rowID = newID;
          createdIDs.push(rowID);
        }
      }
      const newAttrs = {};
      return Object.keys(o).reduce((m, key) => {
        m[`repeating_${sectionName}_${rowID}_${key}`] = o[key];
        return m;
      }, newAttrs);
    })
    .reduce((m, o) => Object.assign(m, o), {});
  setAttrs(setting);
};
 
on("sheet:opened", function () {
  // Make sure to add the attr 'already_transitioned' to the list
  getAttrs(['already_transitioned'], function (attrs) {
    if (attrs.already_transitioned !== '1') {
      getSectionIDs('repeating_inventtab2', idArray => {
        // All the attributes in a repeating row that we care about
        const attrsInSection = ['itemname', 'itemquantity', 'itemcarriedenc', 'itemdesc'],
          // Get an array containing all attribute names for all rows in repeating_inventtab2
          allAttrs = idArray.reduce((m, id) => {
            return m.concat(attrsInSection.map(attr => `repeating_inventtab2_${id}_${attr}`));
          }, []);
        getAttrs(allAttrs, v => {
          let data = [];
          // Construct data from existing attributes
          idArray.forEach(id => {
            data.push({
              itemname: v[`repeating_inventtab2_${id}_itemname`] || '',
              itemquantity: v[`repeating_inventtab2_${id}_itemquantity`] || '',
              itemwornenc: v[`repeating_inventtab2_${id}_itemcarriedenc`] || '',
              itemdesc: v[`repeating_inventtab2_${id}_itemdesc`] || ''
            });
          });
          fillRepeatingSectionFromData('inventtab1', data);
          setAttrs({
            already_transitioned: '1'
          });
        });
      });
    }
  });
});
</script>
 
 
<!-- Sheet code -->
 
<div class="sheet-overall-wrapper">
<div class="sheet-character">
<div class="sheet-header-grid" style="position: relative;">
    <!-- ABSOLUTE POSITIONED LOGO: This won't push the rows down -->
    <div style="position: absolute; left: 0; top: 0; width: 25%; text-align: center;">
        <img src="https://files.d20.io/images/474438152/BoQ62joyuxLvkesD7kO93A/original.png" alt="Logo" width="130">
    </div>
 
    <!-- Row 1 -->
    <div class="sheet-row sheet-no-margin">
        <div class="sheet-col-1-4"></div> <!-- Empty spacer for logo -->
        <div class="sheet-col-1-4 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_character_name"><br/>Character Name</div>
        <div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_race"><br/>Race</div>
        <div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_affinity"><br/>Affinity</div>
        <div class="sheet-col-1-8 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="number" name="attr_level" value="1"><br/>Level</div>
    </div>
 
    <!-- Row 2 -->
    <div class="sheet-row sheet-no-margin">
        <div class="sheet-col-1-4"></div> <!-- Empty spacer for logo -->
        <div class="sheet-col-1-4 sheet-small-label sheet-center">
            <select name="attr_height_class" class="sheet-underlined sheet-center">
                <option value="Short">Short</option>
                <option value="Medium" selected>Medium</option>
                <option value="Tall">Tall</option>
                <option value="Giant">Giant</option>
                <option value="Custom">Custom</option>
            </select><br/>Height
        </div>
        <div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="number" name="attr_bracing_dmg" readonly><br/>Brace</div>
        <div class="sheet-col-1-7 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="text" name="attr_alignment"><br/>Alignment</div>
        <div class="sheet-col-1-8 sheet-small-label sheet-center"><input class="sheet-underlined sheet-center" type="number" name="attr_age"><br/>Age</div>
    </div>
 
<!-- Row 3: The Dual Title Header -->
<div class="sheet-row sheet-no-margin">
    <div class="sheet-col-1-4"></div> <!-- Spacer for logo -->
 
<!-- Title 1 -->
<div class="sheet-col-3-8 sheet-small-label sheet-center">
    <input class="sheet-underlined sheet-center sheet-title-input" type="text" name="attr_title_1" placeholder="Primary Title" readonly>
    
    <!-- The hover container -->
    <div class="sheet-tooltip-container">
        <span class="sheet-title-info">ⓘ</span>
        <!-- This span actually holds the text for the CSS to grab -->
        <span class="sheet-tooltip-text" name="attr_title_1_effect"></span>
    </div>
    <br/>Primary Title
</div>

<!-- Title 2 -->
<div class="sheet-col-3-8 sheet-small-label sheet-center">
    <input class="sheet-underlined sheet-center sheet-title-input" type="text" name="attr_title_2" placeholder="Secondary Title" readonly>
    
    <div class="sheet-tooltip-container">
        <span class="sheet-title-info">ⓘ</span>
        <span class="sheet-tooltip-text" name="attr_title_2_effect"></span>
    </div>
    <br/>Secondary Title
</div>
 
<!-- Hidden inputs to store the effects (You can edit these in the 'Attributes' tab or we can add a 'Notes' section later) -->
<input type="hidden" name="attr_title_1_effect" value="No effect described.">
<input type="hidden" name="attr_title_2_effect" value="No effect described.">
 
</div>
 
	<!-- Tabs-->
	       <input type="radio" name="attr_tab" class="sheet-tab sheet-tab1" value="1" title="Main" checked="checked" />
	  	<span class="sheet-tab sheet-tab1">Stats</span> <!--line 32 -->
          	<input type="radio" name="attr_tab" class="sheet-tab sheet-tab2" value="2" />
		<span class="sheet-tab sheet-tab2">Job</span> <!--line-->
            <input type="radio" name="attr_tab" class="sheet-tab sheet-tab3" value="3" />
    	<span class="sheet-tab sheet-tab3">Combat</span> <!--line -->
		    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab4" value="4" />
		<span class="sheet-tab sheet-tab4">Spellbook</span> <!--line -->
		    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab5" value="5" />
		<span class="sheet-tab sheet-tab5">Equipment</span> <!--line -->
		    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab6" value="6" />
		<span class="sheet-tab sheet-tab6">Traits</span> <!--line -->
		    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab99" value="99" />
		<span class="sheet-tab sheet-tab99">Show All</span>
		<span class="sheet-spacer"></span>
 
			<!--Ability section-->
			    <!--The abiltity adjustment is fitted to a 3rd order polynomial that gives the correct value between 3 and 18-->
<div class="sheet-section-main"> 
<div class="sheet-sub-header">Stat Point (SP) Management</div>
<div class="sheet-row sheet-center" style="margin-bottom: 10px;">
    <!-- SP Earned (Total Budget) -->
    <div class="sheet-col-1-3 sheet-small-label">
        <input type="number" name="attr_sp_total" value="13" readonly class="sheet-underlined sheet-center" style="font-size: 1.2em; color: #2C5D28;">
        <br/>Total SP Earned
    </div>
 
    <!-- SP Spent (Current Usage) -->
    <div class="sheet-col-1-3 sheet-small-label">
        <!-- The "Switch" (Hidden) -->
        <input type="hidden" name="attr_sp_status" class="sheet-sp-status-switch" value="0">
 
        <!-- The Actual Box -->
        <input type="number" name="attr_sp_spent" value="0" readonly class="sheet-underlined sheet-center sheet-sp-usage-box">
        <br/>Total SP Spent
    </div>
 
    <!-- Stat Cap (Level + 10) -->
    <div class="sheet-col-1-3 sheet-small-label">
        <input type="number" name="attr_stat_cap" value="11" readonly class="sheet-underlined sheet-center" style="font-size: 1.2em; color: #a00;">
        <br/>Max Stat Base (Cap)
    </div>
</div>
<div class="sheet-main-stats-container">
 
    <!-- LEFT COLUMN -->
    <div class="sheet-stat-column">
        <h4 class="sheet-center">Core Attributes</h4>
        <div class="sheet-stat-row sheet-small-label">
            <div class="sheet-stat-name">Stat</div>
            <div class="sheet-stat-num sheet-center">Base</div>
            <div class="sheet-stat-num sheet-center">Mod</div>
            <div class="sheet-stat-num sheet-center">Bonus</div>
            <div class="sheet-stat-num sheet-center">Total</div>
            <div class="sheet-stat-roll">Roll</div>
        </div>
 
        <!-- Strength -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Strength</div>
            <div class="sheet-stat-num"><input type="number" name="attr_strength_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_strength_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_strength_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_strength" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_str" value="&{template:5eDefault} {{ability=1}} {{title=Strength}} {{roll=[[[[d20]] + [[@{strength}]]]]}}"></button></div>
        </div>
 
        <!-- Dexterity -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Dexterity</div>
            <div class="sheet-stat-num"><input type="number" name="attr_dexterity_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_dexterity_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_dexterity_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_dexterity" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_dex" value="&{template:5eDefault} {{ability=1}} {{title=Dexterity}} {{roll=[[[[d20]] + [[@{dexterity}]]]]}}"></button></div>
        </div>
 
        <!-- Intelligence -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Intelligence</div>
            <div class="sheet-stat-num"><input type="number" name="attr_intelligence_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_intelligence_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_intelligence_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_intelligence" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_int" value="&{template:5eDefault} {{ability=1}} {{title=Intelligence}} {{roll=[[[[d20]] + [[@{intelligence}]]]]}}"></button></div>
        </div>
 
        <!-- Charisma -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Charisma</div>
            <div class="sheet-stat-num"><input type="number" name="attr_charisma_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_charisma_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_charisma_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_charisma" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_cha" value="&{template:5eDefault} {{ability=1}} {{title=Charisma}} {{roll=[[[[d20]] + [[@{charisma}]]]]}}"></button></div>
        </div>
 
        <!-- Agility -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Agility</div>
            <div class="sheet-stat-num"><input type="number" name="attr_agility_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_agility_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_agility_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_agility" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_agi" value="&{template:5eDefault} {{ability=1}} {{title=Agility}} {{roll=[[[[d20]] + [[@{agility}]]]]}}"></button></div>
        </div>
 
        <!-- Resistance -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Resistance</div>
            <div class="sheet-stat-num"><input type="number" name="attr_resistance_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_resistance_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_resistance_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_resistance" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_res" value="&{template:5eDefault} {{ability=1}} {{title=Resistance}} {{roll=[[[[d20]] + [[@{resistance}]]]]}}"></button></div>
        </div>
 
        <!-- Constitution -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Constitution</div>
            <div class="sheet-stat-num"><input type="number" name="attr_constitution_base" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_constitution_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_constitution_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_constitution" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_con" value="&{template:5eDefault} {{ability=1}} {{title=Constitution}} {{roll=[[[[d20]] + [[@{constitution}]]]]}}"></button></div>
        </div>
 <div style="height: 2px;"></div>
        <div class="sheet-sub-header">Derivative Stats</div>
 
        <!-- Vitality -->
        <div class="sheet-stat-row">
    <div class="sheet-stat-name">Vitality</div>
    <div class="sheet-stat-num"><input type="number" name="attr_vitality_base" value="0" readonly class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_vitality_mod" value="0" class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_vitality_bonus" value="0" class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_vitality" value="0" readonly class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-roll"><button type="roll" name="roll_vit" value="&{template:default} {{name=Vitality Check}} {{Result=[[d20 + @{vitality}]]}}"></button></div>
</div>
        <!-- Finesse -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Finesse</div>
            <div class="sheet-stat-num"><input type="number" name="attr_finesse_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_finesse_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_finesse_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_finesse" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_fin" value="&{template:5eDefault} {{ability=1}} {{title=Finesse}} {{roll=[[[[d20]] + [[@{finesse}]]]]}}"></button></div>
        </div>
 
        <!-- Wisdom -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Wisdom</div>
            <div class="sheet-stat-num"><input type="number" name="attr_wisdom_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_wisdom_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_wisdom_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_wisdom" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_wis" value="&{template:5eDefault} {{ability=1}} {{title=Wisdom}} {{roll=[[[[d20]] + [[@{wisdom}]]]]}}"></button></div>
        </div>
 
        <!-- Willpower -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Willpower</div>
            <div class="sheet-stat-num"><input type="number" name="attr_willpower_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_willpower_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_willpower_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_willpower" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_wil" value="&{template:5eDefault} {{ability=1}} {{title=Willpower}} {{roll=[[[[d20]] + [[@{willpower}]]]]}}"></button></div>
        </div>
    
    <!-- Reflex -->
    <div class="sheet-stat-row">
    <div class="sheet-stat-name">Reflex</div>
    <div class="sheet-stat-num"><input type="number" name="attr_reflex_base" value="0" readonly class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_reflex_mod" value="0" class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_reflex_bonus" value="0" class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_reflex" value="0" readonly class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-roll"><button type="roll" name="roll_reflex" value="&{template:default} {{name=Reflex Check}} {{Result=[[d20 + @{reflex}]]}}"></button>
    </div>
</div>
 
    <!-- RIGHT COLUMN -->
    <div class="sheet-stat-column">
        <div style="height: 5px;"></div>
        <div class="sheet-sub-header">Combat Stats</div>
        <div class="sheet-stat-row sheet-small-label">
            <div class="sheet-stat-name">Stat</div>
            <div class="sheet-stat-num sheet-center">Base</div>
            <div class="sheet-stat-num sheet-center">Mod</div>
            <div class="sheet-stat-num sheet-center">Bonus</div>
            <div class="sheet-stat-num sheet-center">Total</div>
            <div class="sheet-stat-roll">Roll</div>
        </div>
 
        <!-- HP -->
        <div class="sheet-stat-row">
    <div class="sheet-stat-name">HP</div>
    <div class="sheet-stat-num"><input type="number" name="attr_hp_base" value="0" readonly class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_hp_mod" value="0" class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_hp_bonus" value="0" class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-num"><input type="number" name="attr_hp_max" value="0" readonly class="sheet-underlined sheet-center"></div>
    <div class="sheet-stat-roll"></div>
    </div>
 
        <!-- MP -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">MP</div>
            <div class="sheet-stat-num"><input type="number" name="attr_mp_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_mp_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_mp_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_mp_max" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
 
        <!-- STR ATK -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">STR ATK</div>
            <div class="sheet-stat-num"><input type="number" name="attr_str_atk_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_str_atk_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_str_atk_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_str_atk" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
 
        <!-- DEX ATK -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">DEX ATK</div>
            <div class="sheet-stat-num"><input type="number" name="attr_dex_atk_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_dex_atk_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_dex_atk_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_dex_atk" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
 
        <!-- SPL -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">SPL</div>
            <div class="sheet-stat-num"><input type="number" name="attr_spl_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_spl_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_spl_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_spl" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
 
        <!-- EVA -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">EVA</div>
            <div class="sheet-stat-num"><input type="number" name="attr_eva_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_eva_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_eva_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_eva" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_eva" value="&{template:5eDefault} {{ability=1}} {{title=Evasion}} {{roll=[[[[d20]] + [[@{eva}]]]]}}"></button></div>
        </div>
 
        <!-- MOV -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">MOV</div>
            <div class="sheet-stat-num"><input type="number" name="attr_mov_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_mov_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_mov_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_mov" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
 
        <div class="sheet-sub-header">Logistics & Accuracy</div>
 
        <!-- Phys ACC -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Phys. ACC</div>
            <div class="sheet-stat-num"><input type="number" name="attr_acc_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_acc_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_acc_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_acc" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_acc" value="&{template:5eDefault} {{ability=1}} {{title=Physical Accuracy}} {{roll=[[[[d20]] + [[@{acc}]]]]}}"></button></div>
        </div>
 
        <!-- Mag ACC -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Magi. ACC</div>
            <div class="sheet-stat-num"><input type="number" name="attr_macc_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_macc_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_macc_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_macc" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"><button type="roll" name="roll_macc" value="&{template:5eDefault} {{ability=1}} {{title=Magical Accuracy}} {{roll=[[[[d20]] + [[@{mag_acc}]]]]}}"></button></div>
        </div>
 
        <!-- Inv Carry -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Inv. Carry</div>
            <div class="sheet-stat-num"><input type="number" name="attr_icw_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_icw_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_icw_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_icw" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
 
        <!-- Equi Carry -->
        <div class="sheet-stat-row">
            <div class="sheet-stat-name">Equi. Carry</div>
            <div class="sheet-stat-num"><input type="number" name="attr_ecw_base" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_ecw_mod" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_ecw_bonus" value="0" class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-num"><input type="number" name="attr_ecw" value="0" readonly class="sheet-underlined sheet-center"></div>
            <div class="sheet-stat-roll"></div>
        </div>
    </div>
</div>
</div>
	    <!--Class Abilities -->
	<div class="sheet-section-class">
    <!-- JP Management Header -->
    <div class="sheet-sub-header">Job Point (JP) Management</div>
    <div class="sheet-row sheet-center" style="margin-bottom: 10px;">
        <div class="sheet-col-1-3 sheet-small-label">
            <input type="number" name="attr_jp_total" value="0" readonly class="sheet-underlined sheet-center" style="font-size: 1.2em; color: #2C5D28;">
            <br/>Total JP Earned
        </div>
        <div class="sheet-col-1-3 sheet-small-label">
            <input type="hidden" name="attr_jp_status" class="sheet-sp-status-switch" value="0">
            <input type="number" name="attr_jp_spent" value="0" readonly class="sheet-underlined sheet-center sheet-sp-usage-box" style="font-size: 1.2em;">
            <br/>Total JP Spent
        </div>
        <div class="sheet-col-1-3 sheet-small-label">
            <label style="cursor: pointer; margin-top: 5px; display: inline-block;">
                <input type="checkbox" name="attr_is_human" value="1"> <strong>Human</strong>
            </label>
        </div>
    </div>
 
    <div class="sheet-main-stats-container">
        <!-- LEFT COLUMN: RACE -->
        <div class="sheet-stat-column">
            <div class="sheet-sub-header">Race Information</div>
            <div class="sheet-stat-row">
                <div class="sheet-stat-name">Race Name</div>
                <div class="sheet-stat-num" style="flex:3;"><input type="text" name="attr_race_name" class="sheet-underlined"></div>
                <div class="sheet-stat-num">Rank</div>
                <div class="sheet-stat-num"><input type="number" name="attr_race_rank" value="1" class="sheet-underlined sheet-center"></div>
            </div>
 
            <div class="sheet-sub-header">Race Perks</div>
            <textarea name="attr_race_perks" placeholder="Unique Strengths..."></textarea>
 
            <div class="sheet-sub-header">Race Flaws</div>
            <textarea name="attr_race_flaws" placeholder="Unique Weaknesses..."></textarea>
        </div>
 
        <!-- RIGHT COLUMN: JOBS (REPEATING) -->
        <div class="sheet-stat-column">
            <div class="sheet-sub-header">Job Progression</div>
 
<fieldset class="repeating_jobs">
    <!-- Keep all three of these as direct siblings inside the repitem -->
    <input type="checkbox" name="attr_details_toggle" class="sheet-details-toggle" value="1">
    <span class="sheet-details-arrow"></span>
 
    <div class="sheet-stat-row">
        <!-- Job Name and Rank go here -->
        <div class="sheet-stat-name"><input type="text" name="attr_job_name" class="sheet-underlined"></div>
        <div class="sheet-stat-num"><input type="number" name="attr_job_rank" class="sheet-underlined"></div>
    </div>
 
    <!-- This must be a sibling of the checkbox above -->
    <div class="sheet-job-details">
        <textarea name="attr_job_description"></textarea>
    </div>
</fieldset>
        </div>
    </div> <!-- Closes sheet-main-stats-container -->
    <div class="sheet-row"><br/></div>
<div class="sheet-sub-header">Unlocked Titles</div>
 
<fieldset class="repeating_titles">
    <div class="sheet-row">
        <!-- The Selection Checkbox -->
        <div class="sheet-col-1-8 sheet-center">
            <input type="checkbox" name="attr_title_active" value="1">
        </div>
        <div class="sheet-col-1-4">
            <input class="sheet-underlined" type="text" name="attr_library_title_name">
        </div>
        <div class="sheet-col-5-8">
            <textarea name="attr_library_title_effect" style="height: 30px;"></textarea>
        </div>
    </div>
</fieldset>
</div> <!-- Closes sheet-section-class -->
 
 
	<!--Combat-->
	<div class="sheet-section-combat">
    <!-- BLOCK 1: DAMAGE CALCULATOR -->
    <div class="sheet-header-bar">Damage & Defense</div>

    <div class="sheet-damage-panel">
        <div class="sheet-col-1-4 sheet-center">
            <input type="number" name="attr_incoming_dmg" value="0">
            <div class="sheet-small-label">Incoming Damage</div>
        </div>

        <div class="sheet-col-1-4 sheet-center">
            <select name="attr_dmg_type">
                <option value="res" selected>vs RES</option>
                <option value="con">vs CON</option>
            </select>
            <div class="sheet-small-label">Damage Type</div>
        </div>

        <div class="sheet-col-1-4 sheet-center">
            <button type="action" name="act_block_dmg" class="sheet-block-btn">BLOCK</button>
            <div class="sheet-small-label">D20 + Shield</div>
        </div>

        <div class="sheet-col-1-4 sheet-center">
            <button type="action" name="act_take_dmg" class="sheet-take-btn">TAKE DMG</button>
            <div class="sheet-small-label">Base Stats Only</div>
        </div>
    </div>

    <!-- BLOCK 2: SHIELDS -->
    <div class="sheet-header-bar sheet-margin-top">Shields</div>

    <div class="sheet-row">
        <div class="sheet-col-1-3 sheet-small-label">
            <input class="sheet-underlined" type="text" name="attr_shield_name" placeholder="Shield Name">
            <br/>Shield Name
        </div>
        <div class="sheet-col-1-6 sheet-small-label">
            <input class="sheet-underlined sheet-center" type="text" name="attr_shield_class" placeholder="Heavy">
            <br/>Class
        </div>
        <div class="sheet-col-1-6 sheet-small-label">
            <input class="sheet-underlined sheet-center" type="number" name="attr_shield_res_bonus" value="0">
            <br/>+RES
        </div>
        <div class="sheet-col-1-6 sheet-small-label">
            <input class="sheet-underlined sheet-center" type="number" name="attr_shield_con_bonus" value="0">
            <br/>+CON
        </div>
    </div>

    <div class="sheet-row sheet-margin-top">
        <div class="sheet-col-1-1">
            <textarea name="attr_shield_effect" placeholder="Shield Special Effects..." style="height: 40px;"></textarea>
            <div class="sheet-small-label">Shield Special Effects</div>
        </div>
    </div>

    <hr/>
    
    <div class="sheet-header-bar sheet-margin-top">Weapons</div>

<fieldset class="repeating_weapons">
    <div class="sheet-row sheet-weapon-top-row">
        <!-- 1. Weapon Name -->
        <div class="sheet-col-1-4 sheet-small-label">
            <input class="sheet-underlined" type="text" name="attr_weapon_name" placeholder="Name">
            <br/>Weapon Name
        </div>

        <!-- 2. Scaling Dropdown -->
<div class="sheet-col-1-8 sheet-small-label">
    <select name="attr_weapon_scaling_type">
        <option value="str">STR</option>
        <option value="dex">DEX</option>
        <option value="spl">SPL</option>
        <option value="custom">Custom</option>
        <option value="none" selected>N/A</option>
    </select>
    <br/>Scaling
</div>

<!-- 3. Custom Formula (With CSS Toggle Logic) -->
<div class="sheet-col-1-8 sheet-small-label">
    <!-- Hidden input to track the dropdown state -->
    <input type="hidden" class="sheet-scaling-toggle" name="attr_weapon_scaling_type" value="none">
    
    <!-- This div will now be hidden/shown via CSS -->
    <div class="sheet-custom-formula-wrap">
        <input class="sheet-underlined" type="text" name="attr_weapon_custom_formula" placeholder="@{mov}/2">
        <br/>Custom/Bonus
    </div>
</div>

        <!-- 4. Base Damage -->
        <div class="sheet-col-1-8 sheet-small-label">
            <input class="sheet-underlined sheet-center" type="number" name="attr_weapon_base_dmg" value="0">
            <br/>Damage
        </div>

        <!-- 5. Weapon Type -->
        <div class="sheet-col-1-8 sheet-small-label">
            <input class="sheet-underlined sheet-center" type="text" name="attr_weapon_type" placeholder="Type">
            <br/>Type
        </div>

        <!-- 6. Weight -->
        <div class="sheet-col-1-8 sheet-small-label">
            <input class="sheet-underlined sheet-center" type="number" name="attr_weapon_weight" value="0">
            <br/>Weight
        </div>

        <!-- 7. Attack Button -->
        <div class="sheet-col-1-8 sheet-center">
            <button type="roll" name="roll_attack" value="&{template:default} {{name=@{character_name} Attacks!}} {{Weapon=@{weapon_name}}} {{Type=@{weapon_type}}} {{Damage=[[ @{weapon_base_dmg} + @{weapon_scaling_calc} ]]}}">ATTACK</button>
            <input type="hidden" name="attr_weapon_scaling_calc" value="0">
        </div>
    </div>

    <!-- Row 2: Unique Skill & Effects -->
    <div class="sheet-row sheet-weapon-bottom-row">
        <div class="sheet-col-3-4 sheet-small-label">
            <textarea name="attr_weapon_skill_desc" placeholder="Weapon Skill / Effects..." style="height: 35px;"></textarea>
            <br/>Unique Skill & Special Effects
        </div>
        <div class="sheet-col-1-4 sheet-center">
            <button type="roll" class="sheet-skill-btn" name="roll_weapon_skill" value="&{template:default} {{name=@{weapon_name}: Skill Use}} {{Effect=@{weapon_skill_desc}}}">
                USE SKILL
            </button>
        </div>
    </div>
</fieldset>
</div>

 
	<!--Spellbook-->
	<div class="sheet-section-spellbook sheet-center">
			<div class="sheet-row sheet sheet-center">
				<div class="sheet-col-1"><h4 class="sheet-center">Spell Slots</h4></div>
					<div class="sheet-row sheet-sub-header">
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Slots</div>
    					<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 0</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 1</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 2</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 3</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 4</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 5</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 6</div>
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Level 7</div>
					</div>
					<div class="sheet-row">
						<div class="sheet-col-1-12 sheet-center sheet-small-label">Castable</div>
    					<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_o1_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l1_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l2_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l3_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l4_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l5_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l6_max" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l7_max" value="0"></div>
					</div>
					<!-->
					<div class="sheet-row">
						<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Used</div>
    					<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_o1" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l1" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l2" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l3" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l4" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l5" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l6" value="0"></div>
						<div class="sheet-col-1-12"><input type="number" name="attr_spell_slots_l7" value="0"></div>
					</div>
					</!-->
			</div>
			<span class="sheet-spacer"></span>
				<h4 class="sheet-center">Spell Book</h4>
				<!--Tabs for spell types-->
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab0" value="0" title="Level 0" checked="checked" />
					<span class="sheet-spellpagetab sheet-spelltab0">Level 0</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab1" value="1" title="Level 1" />
					<span class="sheet-spellpagetab sheet-spelltab1">Level 1</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab2" value="2" title="Level 2" />
					<span class="sheet-spellpagetab sheet-spelltab2">Level 2</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab3" value="3" title="Level 3" />
					<span class="sheet-spellpagetab sheet-spelltab3">Level 3</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab4" value="4" title="Level 4" />
					<span class="sheet-spellpagetab sheet-spelltab4">Level 4</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab5" value="5" title="Level 5" />
					<span class="sheet-spellpagetab sheet-spelltab5">Level 5</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab6" value="6" title="Level 6" />
					<span class="sheet-spellpagetab sheet-spelltab6">Level 6</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab7" value="7" title="Level 7" />
					<span class="sheet-spellpagetab sheet-spelltab7">Level 7</span>
					<input type="radio" name="attr_spellpagetab" class="sheet-spellpagetab sheet-spelltab99" value="99" title="Show All" />
					<span class="sheet-spellpagetab sheet-spelltab99">Show All</span>
				<span class="sheet-spacer"></span>
 
				<!--Level 0 Tab-->
				<div class="sheet-spell-page0">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Cantrips/Orisions</div>
					</div>
					<fieldset class="repeating_spellbookcantrip">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 0<input type="hidden" name="attr_spellfriendlylevel" value="0"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				<!--Level 1 Tab-->
				<div class="sheet-spell-page1">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 1</div>
					</div>
					<fieldset class="repeating_spellbooklvl1">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 1<input type="hidden" name="attr_spellfriendlylevel" value="1"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				 <!--Level 2 Tab-->
				<div class="sheet-spell-page2">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 2</div>
					</div>
					<fieldset class="repeating_spellbooklvl2">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 2<input type="hidden" name="attr_spellfriendlylevel" value="2"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				 <!--Level 3 Tab-->
				<div class="sheet-spell-page3">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 3</div>
					</div>
					<fieldset class="repeating_spellbooklvl3">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 3<input type="hidden" name="attr_spellfriendlylevel" value="3"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				 <!--Level 4 Tab-->
				<div class="sheet-spell-page4">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 4</div>
					</div>
					<fieldset class="repeating_spellbooklvl4">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 4<input type="hidden" name="attr_spellfriendlylevel" value="4"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				<!--Level 5 Tab-->
				<div class="sheet-spell-page5">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 5</div>
					</div>
					<fieldset class="repeating_spellbooklvl5">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 5<input type="hidden" name="attr_spellfriendlylevel" value="5"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				<!--Level 6 Tab-->
				<div class="sheet-spell-page6">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 6</div>
					</div>
					<fieldset class="repeating_spellbooklvl6">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 6<input type="hidden" name="attr_spellfriendlylevel" value="6"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
 
				<!--Level 7 Tab-->
				<div class="sheet-spell-page7">
					<div class="sheet-row sheet-spell-header">
						<div class="sheet-col-1 sheet-vert-bottom sheet-center sheet-small-label">Level 7</div>
					</div>
					<fieldset class="repeating_spellbooklvl7">
					<!-- BEGIN spell row -->
					    <div class="sheet-margin-bottom sheet-padr sheet-padl">
    					<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-bottom sheet-center sheet-small-label">Spell Level</div>
							<div class="sheet-col-1-3 sheet-vert-bottom sheet-center sheet-small-label">Spell name</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-12 sheet-vert-middle sheet-center sheet-padr">Level 7<input type="hidden" name="attr_spellfriendlylevel" value="7"></div>
							<div class="sheet-col-1-3 sheet-vert-middle sheet-padr"><input type="text" class=" sheet-center" name="attr_spellname"></div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Target/Area of Effect</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Range</div>
							<div class="sheet-col-1-8 sheet-vert-bottom sheet-center sheet-small-label">Duration</div>
							<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Info</div>
						</div>
						<div class="sheet-row">
							<div class="sheet-col-1-6 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spelltarget"></div>
    						<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellrange"></div>
							<div class="sheet-col-1-8 sheet-vert-middle sheet-padr"><input type="text" class="sheet-center" name="attr_spellduration"></div>
							<div class="sheet-col-1-6 sheet-vert-middle sheet-center sheet-padr"><button type="roll" class="sheet-roll" name="roll_SpellCast" value="&{template:5eDefault} {{spell=1}} {{title=@{spellname}}} {{subheader=@{character_name}}} {{subheader2=level @{spellfriendlylevel}}} @{spellcastmacrooptions}} {{spellduration=@{spellduration}}} {{spelltarget=@{spelltarget}}} {{spellrange=@{spellrange}}}">Spell Info</button></div>
						</div>
						<div class="sheet-row sheet-padb sheet-spell-macro-output-options">
							<div class="sheet-col-1-8 sheet-vert-middle sheet-small-label sheet-padl">Spell info macro display options</div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Info block<br/><input type="checkbox" name="attr_spellshowinfoblock" value="{{spellshowinfoblock=1}}" /></div>
							<div class="sheet-col-1-8 sheet-center sheet-small-label">Saving throw<br/><input type="checkbox" name="attr_spellshowsavethrow" value="{{spellshowsavethrow=1}} {{spellsavestat=@{savestat}}} {{spellsavesuccess=@{savesuccess}}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Healing<br/><input type="checkbox" name="attr_spellshowhealing" value="{{spellshowhealing=1}} {{spellhealing=[[@{spellhealamount} + @{healstatbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Damage<br/><input type="checkbox" name="attr_spellshowdamage" value="{{spellshowdamage=1}} {{spelldamage=[[@{damage} + @{damagestatbonus} + @{damagemiscbonus}]]}}" /></div>
							<div class="sheet-col-1-12 sheet-center sheet-small-label">Effects<br/><input type="checkbox" name="attr_spellshoweffects" value="{{spellshoweffects=1}} {{spelleffect=@{spelleffect}}" /></div>
							<input type="hidden" name="attr_spellcastmacrooptions" value="@{spellshowinfoblock}  @{spellshowsavethrow} @{spellshowhealing} @{spellshowdamage} @{spellshoweffects}" />
						</div>
						<span class="sheet-spacer"></span>
						<span class="sheet-small-label">Show :</span>
							<input type="checkbox" name="attr_spelltypesave" class="sheet-spelltypetab sheet-spelltypesave" value="1" /><span class="sheet-spelltypetab sheet-spelltypesave">Save</span>
							<input type="checkbox" name="attr_spelltypeheal" class="sheet-spelltypetab sheet-spelltypeheal" value="1" /><span class="sheet-spelltypetab sheet-spelltypeheal">Healing</span>
							<input type="checkbox" name="attr_spelltypdamage" class="sheet-spelltypetab sheet-spelltypedamage" value="1" /><span class="sheet-spelltypetab sheet-spelltypedamage">Damage</span>
							<input type="checkbox" name="attr_spelltypeeffects" class="sheet-spelltypetab sheet-spelltypeeffects" value="1" /><span class="sheet-spelltypetab sheet-spelltypeeffects">Effects</span>
						<span class="sheet-spacer"></span>
						<div class="sheet-spell-type-save">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-right sheet-small-label">Target saves vs</div>
								<div class="sheet-col-1-2 sheet-center sheet-small-label">What happens on a successful save</div>
								<div class="sheet-col-1-6 sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr">
										<select name="attr_savestat">
										<option value="Death Ray">Death Ray</option>
										<option value="Poison">Poison</option>
										<option value="Magic Wands">Magic Wands</option>
										<option value="Paralysis">Paralysis</option>
										<option value="Turn to Stone">Turn to Stone</option>
										<option value="Dragon's Breath">Dragon's Breath</option>
										<option value="Spell">Spell</option>
									</select>
								</div>
								<div class="sheet-col-1-2 sheet-padl"><input type="text" class="sheet-center" name="attr_savesuccess" title="What happens if the save is successful"></div>
							</div>
						</div>
						<div class="sheet-spell-type-heal">
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padl sheet-padr sheet-vert-bottom sheet-right sheet-small-label">Heal amount</div>
								<div class="sheet-col-1-6 sheet-padl sheet-vert-bottom sheet-right sheet-small-label">Stat Bonus</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-6 sheet-padr sheet-small-label sheet-center"><input type="text" class="sheet-center" name="attr_spellhealamount" value="0"></div>
								<div class="sheet-col-1-6 sheet-center">
									<select name="attr_healstatbonus">
										<option value="0">None</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
							</div>
						</div>
						<div class="sheet-spell-type-damage">
							<div class="sheet-row">
								<div class="sheet-col-1-4 sheet-vert-bottom sheet-right sheet-small-label">Damage Dice</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-right sheet-small-label">Other Bonus</div>
								<div class="sheet-col-1-8 sheet-vert-bottom sheet-right sheet-small-label">Damage Misc</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1-10 sheet-padr sheet-small-label sheet-left"><input type="text" class="sheet-center" name="attr_damage" value="0"></div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr">
									<select name="attr_damagestatbonus">
										<option value="0">None</option>
										<option value="[[@{intelligence_mod}]]">INT mod</option>
										<option value="[[@{wisdom_mod}]]">WIS mod</option>
									</select>
								</div>
								<div class="sheet-col-1-8 sheet-padl sheet-padr sheet-small-label sheet-left"><input type="number" class="sheet-center" name="attr_damagemiscbonus" value="0" step="1"></div>
								</div>
						</div>
						<div class="sheet-spell-type-effects">
							<div class="sheet-row">
								<div class="sheet-col-5-6 sheet-vert-bottom sheet-center sheet-small-label">Spell Effects</div>
								<div class="sheet-col-1-6 sheet-vert-bottom sheet-center sheet-small-label">&nbsp;</div>
							</div>
							<div class="sheet-row">
								<div class="sheet-col-1 sheet-small-label sheet-center"><textarea name="attr_spelleffect" class="sheet-medium-textarea">None</textarea></div>
							</div>
						</div>
					</div>
					<!-- END spell row -->
					</fieldset>
				</div>
	</div>
 
	<!--Inventory -->
	<div class="sheet-section-inventory">
		<div class="sheet-row ">
			<!-- Loot-->
			<div class="sheet-col-1-2 sheet-padr">
				<h4 class="sheet-center">Coin Carried </h4>
				<div class="sheet-row sheet-sub-header sheet-center">
					<div class="sheet-col-1-4 sheet-center sheet-small-label">CP</div>
					<div class="sheet-col-1-4 sheet-center sheet-small-label">SP</div>
					<div class="sheet-col-1-4 sheet-center sheet-small-label">GP</div>
					<div class="sheet-col-1-4 sheet-center sheet-small-label">Total Value(GP)</div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-4" title="Copper Pieces"><input type="number" name="attr_cp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-4" title="Silver Pieces"><input type="number" name="attr_sp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-4" title="Gold Pieces"><input type="number" name="attr_gp" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-4" title="Total (in Gold Pieces)"><input type="number" name="attr_money_total_gp" value="(@{cp} / 100) + (@{sp} / 10) +  @{gp} " disabled="disabled"></div>
				</div>
				<h4 class="sheet-center">Weight</h4>
				<div class="sheet-row sheet-sub-header sheet-center">
					<div class="sheet-col-1-4 sheet-center sheet-small-label">Equipment</div>
					<div class="sheet-col-1-4 sheet-center sheet-small-label">Coin</div>
					<div class="sheet-col-1-4 sheet-center sheet-small-label">Other</div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-4 sheet-center"><input style="display: none;" type="text" name="attr_tempweight" value="0"><input type="number" name="attr_inventory_weight" title="Total of your equipment Worn and Carried" value="@{tempweight}" disabled="disabled"></div>
					<div class="sheet-col-1-4 sheet-center"><input type="number" name="attr_coin_weight" title="This entry rounds to the nearest whole value" value="round(((@{CP} + @{SP} + @{GP})/10))" disabled="disabled"></div>
					<div class="sheet-col-1-4 sheet-center"><input type="number" name="attr_other_weight" value="0" min="0"></div>
					</div>
				<h4 class="sheet-center">Carry Capacity</h4>
				<div class="sheet-row sheet-sub-header sheet-center">
					<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padr">Current Load</div>	
					<div class="sheet-col-1-4 sheet-left sheet-small-label">Light Load Limit</div>
				    <div class="sheet-col-1-4 sheet-right sheet-small-label">Heavy Load Limit</div>
				</div>
				<div class="sheet-row sheet-center">
					<div class="sheet-col-1-4 sheet-left" title="Current Load"><input type="number" name="attr_total_weight" value="@{inventory_weight} + @{coin_weight} + @{other_weight}" disabled="disabled"></div>
					<div class="sheet-col-1-4 sheet-right"  title="Light Load"><input type="number" name="attr_lightload" value="0" min="0" step="1"></div>
					<div class="sheet-col-1-4 sheet-right" title="Heavy Load"><input type="number" name="attr_heavyload" value="0" min="0" step="1"></div>
					</div>
			</div>
			<!-- Inventory tab -->
            <div class="sheet-col-1-2">
                <h4 class="sheet-center">Treasure Notes </h4>
				<textarea name="attr_lootnotes"></textarea>
			</div>
		</div>
		<h4 class="sheet-center">Equipment </h4>
			<input type="radio" name="attr_inventorytab" class="sheet-inventorytab sheet-inventorytab1" value="1" title="Page 1" checked="checked" />
			<span class="sheet-inventorytab sheet-inventorytab1">On Person</span>
			<input type="radio" name="attr_inventorytab" class="sheet-inventorytab sheet-inventorytab3" value="3" title="Page 3" />
			<span class="sheet-inventorytab sheet-inventorytab3">Transportation</span>
			<input type="radio" name="attr_inventorytab" class="sheet-inventorytab sheet-inventorytab4" value="4" title="Page 4" />
			<span class="sheet-inventorytab sheet-inventorytab4">Elsewhere</span>
			<input type="radio" name="attr_inventorytab" class="sheet-inventorytab sheet-inventorytab99" value="99" title="Show All" />
			<span class="sheet-inventorytab sheet-inventorytab99">Show All</span>
			<span class="sheet-spacer"></span>
 
			<!-- Inventory Page 1-->
			<div class="sheet-inventory-page1">
				<input type="text" class="sheet-center sheet-sub-header" name="attr_tabinvtitle1" value="What is being worn or carried on person " disabled="disabled">
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Qty</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Weight</div>
					<div class="sheet-col-1-2 sheet-center sheet-small-label sheet-padl">Notes</div>
				</div>
				<fieldset class="repeating_inventtab1">
					<div class="sheet-row">
						<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
						<div class="sheet-col-1-12 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
						<div class="sheet-col-1-12 sheet-padl sheet-center"><input type="number" name="attr_itemwornenc"></div>
						<div class="sheet-col-1-2 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
					</div>
				</fieldset>
			</div>
			<!-- Inventory Page 3-->
			<div class="sheet-inventory-page3">
				<input type="text" class="sheet-center sheet-sub-header" name="attr_tabinvtitle3" value="What is carried by your horse or wagon" disabled="disabled">
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Qty</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Weight</div>
					<div class="sheet-col-1-2 sheet-center sheet-small-label sheet-padl">Notes</div>
				</div>
				<fieldset class="repeating_inventtab3">
					<div class="sheet-row">
						<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
						<div class="sheet-col-1-12 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
						<div class="sheet-col-1-12 sheet-padl sheet-center"><input type="number" name="attr_itemtransportationenc"></div>
						<div class="sheet-col-1-2 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
					</div>
				</fieldset>
			</div>
			<!-- Inventory Page 4-->
			<div class="sheet-inventory-page4">
				<input type="text" class="sheet-center sheet-sub-header" name="attr_tabinvtitle4" value="What is stored elsewhere such as in a vault or stronghold" disabled="disabled">
				<div class="sheet-row sheet-sub-header">
					<div class="sheet-col-1-4 sheet-center sheet-small-label sheet-padl">Name</div>
					<div class="sheet-col-1-12 sheet-center sheet-small-label">Qty</div>
					<div class="sheet-col-1-2 sheet-center sheet-small-label sheet-padl">Notes</div>
				</div>
				<fieldset class="repeating_inventtab4">
					<div class="sheet-row">
						<div class="sheet-col-1-4 sheet-small-label sheet-left"><input type="text" name="attr_itemname"></div>
						<div class="sheet-col-1-12 sheet-padl sheet-center"><input type="number" name="attr_itemquantity"></div>
						<div class="sheet-col-1-2 sheet-padl sheet-small-label sheet-left"><input type="text" name="attr_itemdesc"></div>
					</div>
				</fieldset>
			</div>
	</div>
	<span class="sheet-spacer"></span>
					<h4 class="sheet-center">Game Notes</h4>
				<textarea name="attr_gamenotes" title="Game notes"></textarea>
<!-- End of PC Sheet-->
 
<!--Footer -->
	<div class="sheet-row sheet-footer">
		<div class="sheet-col-1 sheet-small-label sheet-center">
			<img src="http://i.imgur.com/QQpi55r.png" width=300 >
		</div>
	</div>
</div>
 
 
<!-- Roll Templates -->
<rolltemplate class="sheet-rolltemplate-5eDefault">
	<div class="sheet-rt-card">
		<div class="sheet-rt-header{{#weapon}} sheet-weapon{{/weapon}}{{#spell}} sheet-spell{{/spell}}{{#ability}} sheet-ability{{/ability}}{{#save}} sheet-save{{/save}}{{#deathsave}} sheet-deathsave{{/deathsave}}">
			<div class="sheet-rt-title">{{title}}</div>
			{{#subheader}}
			<div class="sheet-rt-subheader">{{subheader}}{{#subheaderright}} &bullet; {{subheaderright}}{{/subheaderright}}</div>
			{{/subheader}}
			{{#subheader2}}
			<div class="sheet-rt-subheader">{{subheader2}}{{#subheaderright2}} &bullet; {{subheaderright2}}{{/subheaderright2}}</div>
			{{/subheader2}}
		</div>
			{{#emote}}
			<p class="sheet-rt-emote">{{character_name}} {{emote}}</p>
			{{/emote}}
			<div class="sheet-main-content">
 
				<!--Weapon based attacks-->
				{{#attack}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">hits AC {{attack}}</div>
				</div>
				{{/attack}}
				{{#damage}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{damage}}</div>
				</div>
				{{/damage}}
				{{#attackshowinfoblock}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-center">Range</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{attackrange}}</div>
				</div>
				{{/attackshowinfoblock}}
 
				<!--Spellcasting-->
				{{#spellshowinfoblock}}
				<div class="sheet-row sheet-padb">
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Duration</span><br/><span class="sheet-rt-value">{{spellduration}}</span></div>
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Target/AoE</span><br/><span class="sheet-rt-value">{{spelltarget}}</span></div>
					<div class="sheet-col-1-2 sheet-padl sheet-padr sheet-center"><span class="sheet-rt-key">Range</span></div>
					<div class="sheet-col-1-2 sheet-left"><span class="sheet-rt-value">{{spellrange}}</span></div>
				</div>
				{{/spellshowinfoblock}}
				{{#spellshowattack}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellattack}} AC Hit</div>
				</div>
				{{/spellshowattack}}
				{{#spellshowsavethrow}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellsavestat}}</div>
				</div>
				{{/spellshowsavethrow}}
				{{#spellshowhealing}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Healing</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellhealing}} HP healed</div>
				</div>
				{{/spellshowhealing}}
				{{#spellshowdamage}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spelldamage}}</div>
				</div>
				{{/spellshowdamage}}
				{{#spellshoweffects}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Effect</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spelleffect}}</div>
				</div>
				{{/spellshoweffects}}
				{{#spellshowsavethrow}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Save success</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{spellsavesuccess}}</div>
				</div>
				{{/spellshowsavethrow}}
 
				<!--NPC-->
				{{#npccorestats}}
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-key">Stat</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-key">Score</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-key">Mod</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">STR</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_strength}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_strength_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">DEX</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_dexterity}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_dexterity_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">CON</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_constitution}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_constitution_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">INT</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_intelligence}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_intelligence_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">WIS</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_wisdom}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_wisdom_mod}}</div>
				</div>
				<div class="sheet-row">
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">CHA</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_charisma}}</div>
					<div class="sheet-col-1-3 sheet-padl sheet-padr sheet-rt-value">{{npc_charisma_mod}}</div>
				</div>
				{{/npccorestats}}
				<!--Generic section-->
				{{#freetext}}
					<div class="sheet-row">
						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key-wide">{{freetextname}}</div>
						<div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{freetext}}</div>
					</div>
				{{/freetext}}
				{{#roll}}
				<div class="sheet-row">
					<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{rollname}}</div>
					<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll}}</div>
				</div>
				{{/roll}}
				<!--Outputall-->
				{{#outputall}}
					{{#allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save deathsave}}
						<div class="sheet-row">
							<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{key}}</div>
							<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops() outputall title subheader subheaderright subheader2 subheaderright2 emote weapon spell ability save deathsave}}
				{{/outputall}}
				<!--DEBUG-->
				{{#debug}}
					{{#allprops()}}
						<div class="sheet-row">
							<div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{key}} (DEBUG)</div>
							<div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{value}}</div>
						</div>
					{{/allprops()}}
				{{/debug}}
			</div>
		</div>
</rolltemplate>
 
 
<script type="text/worker">

on("change:level change:height_class change:race_rank change:is_human change:repeating_jobs:job_rank remove:repeating_jobs " +
   "change:strength_base change:dexterity_base change:intelligence_base change:charisma_base change:agility_base change:resistance_base change:constitution_base " +
   "change:strength_mod change:dexterity_mod change:intelligence_mod change:charisma_mod change:agility_mod change:resistance_mod change:constitution_mod " +
   "change:strength_bonus change:dexterity_bonus change:intelligence_bonus change:charisma_bonus change:agility_bonus change:resistance_bonus change:constitution_bonus " +
   "change:vitality_mod change:wisdom_mod change:finesse_mod change:willpower_mod change:reflex_mod " +
   "change:vitality_bonus change:wisdom_bonus change:finesse_bonus change:willpower_bonus change:reflex_bonus " +
   "change:str_atk_mod change:str_atk_bonus " +
"change:dex_atk_mod change:dex_atk_bonus " +
"change:spl_mod change:spl_bonus " +
"change:icw_mod change:icw_bonus " +
"change:ecw_mod change:ecw_bonus " +
   "change:hp_mod change:hp_bonus change:mp_mod change:mp_bonus change:acc_mod change:acc_bonus change:macc_mod change:macc_bonus change:eva_mod change:eva_bonus change:mov_mod change:mov_bonus", function() {
    
    const coreNames = ["strength", "dexterity", "intelligence", "charisma", "agility", "resistance", "constitution"];
    const derivativeNames = ["vitality", "wisdom", "finesse", "willpower", "reflex"];
    
    let attrList = ["level", "height_class", "race_rank", "is_human", "hp_mod", "hp_bonus", "mp_mod", "mp_bonus", "acc_mod", "acc_bonus", "macc_mod", "macc_bonus", "eva_mod", "eva_bonus", "mov_mod", "mov_bonus","str_atk_mod", "str_atk_bonus", "dex_atk_mod", "dex_atk_bonus", "spl_mod", "spl_bonus", "icw_mod", "icw_bonus", "ecw_mod", "ecw_bonus"];
    [...coreNames, ...derivativeNames].forEach(s => {
        attrList.push(s + "_base", s + "_mod", s + "_bonus");
    });

    getAttrs(attrList, function(v) {
        const level = parseInt(v.level) || 1;
        const height = v.height_class;
        const cap = level + 10;
        let finalAttrs = {};
        let spentSP = 0;

        // --- PASS 1: CORE STATS & SP CAPS ---
        coreNames.forEach(s => {
            let base = parseInt(v[s + "_base"]) || 0;
            if (base > cap) { base = cap; finalAttrs[s + "_base"] = cap; }
            spentSP += Math.max(0, base - 1);

            let hMod = (s === "resistance" || s === "constitution") ? (height === "Short" ? -1 : height === "Tall" ? 1 : height === "Giant" ? 2 : 0) : 0;
            finalAttrs[s + "_total"] = base + (parseInt(v[s + "_mod"]) || 0) + (parseInt(v[s + "_bonus"]) || 0) + hMod;
        });

        // --- PASS 2: DERIVATIVE BASES (Higher-Of Logic) ---
        finalAttrs["vitality_base"]  = Math.floor(((finalAttrs.resistance_total + finalAttrs.constitution_total) / 2) + (finalAttrs.strength_total / 3));
        finalAttrs["wisdom_base"]    = Math.floor((Math.max(finalAttrs.intelligence_total, finalAttrs.charisma_total) / 2) + (finalAttrs.dexterity_total / 3));
        finalAttrs["finesse_base"]   = Math.floor((finalAttrs.dexterity_total / 2) + (Math.max(finalAttrs.agility_total, finalAttrs.intelligence_total) / 3));
        finalAttrs["willpower_base"] = Math.floor((finalAttrs.charisma_total / 2) + (finalAttrs.strength_total / 3));
        finalAttrs["reflex_base"]    = Math.floor((finalAttrs.agility_total / 2) + (Math.max(finalAttrs.dexterity_total, finalAttrs.intelligence_total) / 3));

        // --- PASS 3: DERIVATIVE TOTALS ---
        derivativeNames.forEach(s => {
            finalAttrs[s] = (finalAttrs[s + "_base"] || 0) + (parseInt(v[s + "_mod"]) || 0) + (parseInt(v[s + "_bonus"]) || 0);
        });

        // --- PASS 4: COMBAT & RESOURCE BASES (With Rounding) ---
        finalAttrs["hp_base"] = (finalAttrs.vitality * 2) + (level * 2) + 40;
        finalAttrs["hp_max"]  = finalAttrs.hp_base + (parseInt(v.hp_mod) || 0) + (parseInt(v.hp_bonus) || 0);
        
        let rawMP = (finalAttrs.wisdom * 2) + (level * 2) + 5;
        finalAttrs["mp_base"] = Math.round(rawMP / 10) * 10;
        finalAttrs["mp_max"]  = finalAttrs.mp_base + (parseInt(v.mp_mod) || 0) + (parseInt(v.mp_bonus) || 0);

        finalAttrs["str_atk_base"] = Math.floor(finalAttrs.strength_total / 2);
        finalAttrs["str_atk"]      = finalAttrs.str_atk_base + (parseInt(v.str_atk_mod) || 0) + (parseInt(v.str_atk_bonus) || 0);
        
        finalAttrs["dex_atk_base"] = Math.floor(finalAttrs.dexterity_total / 2.5);
        finalAttrs["dex_atk"]      = finalAttrs.dex_atk_base + (parseInt(v.dex_atk_mod) || 0) + (parseInt(v.dex_atk_bonus) || 0);
        
        finalAttrs["spl_base"]     = Math.floor(finalAttrs.intelligence_total / 2.5);
        finalAttrs["spl"]      = finalAttrs.spl_base + (parseInt(v.spl_mod) || 0) + (parseInt(v.spl_bonus) || 0);

        finalAttrs["eva_base"] = Math.floor(((finalAttrs.agility_total / 2) + (finalAttrs.reflex / 2)) / 2);
        finalAttrs["eva"]      = finalAttrs.eva_base + (parseInt(v.eva_mod) || 0) + (parseInt(v.eva_bonus) || 0);

        let rawMov = ((finalAttrs.finesse + finalAttrs.reflex) / 2) + 5;
        finalAttrs["mov_base"] = Math.round(rawMov / 5) * 5;
        finalAttrs["mov"]      = finalAttrs.mov_base + (parseInt(v.mov_mod) || 0) + (parseInt(v.mov_bonus) || 0);

        finalAttrs["acc_base"]  = Math.floor(((finalAttrs.dexterity_total / 2) + (finalAttrs.finesse / 2)) / 2);
        finalAttrs["acc"]       = finalAttrs.acc_base + (parseInt(v.acc_mod) || 0) + (parseInt(v.acc_bonus) || 0);
        
        finalAttrs["macc_base"] = Math.floor(((finalAttrs.intelligence_total / 2) + (finalAttrs.wisdom / 2)) / 2);
        finalAttrs["macc"]      = finalAttrs.macc_base + (parseInt(v.macc_mod) || 0) + (parseInt(v.macc_bonus) || 0);

        finalAttrs["icw_base"] = (finalAttrs.vitality * 3) + 5;
        finalAttrs["icw"] = finalAttrs.icw_base + (parseInt(v.icw_mod) || 0) + (parseInt(v.icw_bonus) || 0);
        finalAttrs["ecw_base"] = (finalAttrs.vitality * 2) + 10;
        finalAttrs["ecw"] = finalAttrs.ecw_base + (parseInt(v.ecw_mod) || 0) + (parseInt(v.ecw_bonus) || 0);

        // --- PASS 5: BUDGETS (SP/JP System) ---
        getSectionIDs("repeating_jobs", function(idarray) {
            const jobFields = idarray.map(id => `repeating_jobs_${id}_job_rank`);
            getAttrs(jobFields, function(rows) {
                let spFromRanks = 0;
                let totalJPUsed = Math.max(0, parseInt(v.race_rank) || 0);
                const calcSP = (rank) => {
                    let earned = 0;
                    for (let i = 1; i <= rank; i++) { if (i !== 1 && i !== 3 && (i <= 3 || i % 3 !== 0)) earned++; }
                    return earned;
                };
                spFromRanks += calcSP(totalJPUsed);
                idarray.forEach(id => {
                    let r = parseInt(rows[`repeating_jobs_${id}_job_rank`]) || 0;
                    totalJPUsed += r;
                    spFromRanks += calcSP(r);
                });

                const spTotalBudget = 10 + (level * 3) + spFromRanks;
                finalAttrs["sp_total"] = spTotalBudget;
                finalAttrs["sp_spent"] = spentSP;
                finalAttrs["sp_status"] = (spentSP > spTotalBudget) ? 1 : 0;
                finalAttrs["jp_total"] = Math.max(0, (level - 1) + (parseInt(v.is_human) || 0));
                finalAttrs["jp_spent"] = Math.max(0, totalJPUsed - 2);
                finalAttrs["jp_status"] = (finalAttrs.jp_spent > finalAttrs.jp_total) ? 1 : 0;
                
                // Final data mapping to HTML
finalAttrs["strength"]     = finalAttrs.strength_total;
finalAttrs["dexterity"]    = finalAttrs.dexterity_total;
finalAttrs["intelligence"] = finalAttrs.intelligence_total;
finalAttrs["charisma"]     = finalAttrs.charisma_total;
finalAttrs["agility"]      = finalAttrs.agility_total;
finalAttrs["resistance"]   = finalAttrs.resistance_total;
finalAttrs["constitution"] = finalAttrs.constitution_total;

                setAttrs(finalAttrs);
            });
        });
    });
});
 
    /* --- SCRIPT 2: TITLE LIBRARY ENFORCER --- */
    on("change:repeating_titles:title_active", function(eventInfo) {
        getSectionIDs("repeating_titles", function(idarray) {
            const fields = [];
            idarray.forEach(id => {
                fields.push(`repeating_titles_${id}_title_active`, `repeating_titles_${id}_library_title_name`, `repeating_titles_${id}_library_title_effect`);
            });
 
            getAttrs(fields, function(v) {
                let activeIDs = idarray.filter(id => parseInt(v[`repeating_titles_${id}_title_active`]) === 1);
                let update = {};
 
                // Limit to 2: If user checks a 3rd, uncheck it immediately
                if (activeIDs.length > 2) {
                    const sourceID = eventInfo.sourceAttribute.split("_")[2];
                    update[`repeating_titles_${sourceID}_title_active`] = 0;
                    activeIDs = activeIDs.filter(id => id !== sourceID);
                }
 
                // Sync Header Title 1
                if (activeIDs[0]) {
                    update["title_1"] = v[`repeating_titles_${activeIDs[0]}_library_title_name`];
                    update["title_1_effect"] = v[`repeating_titles_${activeIDs[0]}_library_title_effect`];
                } else {
                    update["title_1"] = "";
                    update["title_1_effect"] = "No title equipped.";
                }
 
                // Sync Header Title 2
                if (activeIDs[1]) {
                    update["title_2"] = v[`repeating_titles_${activeIDs[1]}_library_title_name`];
                    update["title_2_effect"] = v[`repeating_titles_${activeIDs[1]}_library_title_effect`];
                } else {
                    update["title_2"] = "";
                    update["title_2_effect"] = "No title equipped.";
                }
 
                setAttrs(update);
            });
        });
    });
    

// Listeners for the two buttons
on("clicked:block_dmg", (info) => handleDamage(true, info));
on("clicked:take_dmg", (info) => handleDamage(false, info));

</script>
 
